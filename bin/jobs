#!/usr/bin/env ruby

# Load .env before Rails boots so env vars are available to initializers
# and service objects regardless of how this process was started.
require "bundler/setup"
require "dotenv/load"

require_relative "../config/environment"
require "solid_queue/cli"

# Broadcast Rails.logger to stdout so job debug logs appear in foreman output
if Rails.env.development?
  stdout_logger = ActiveSupport::Logger.new($stdout)
  stdout_logger.formatter = Rails.logger.formatter
  Rails.logger.broadcast_to(stdout_logger)
end

SolidQueue::Cli.start(ARGV)
